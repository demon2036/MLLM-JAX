# GRPO/GSM8K config: batch_size=128 sequences per training step (global)
#
# In this repo:
# - `rollout.batch_size` is sequences per training step (global, across all processes)
# - `rollout.n` is samples per prompt (GRPO group size, K)
# - prompts per training step (global) = rollout.batch_size / rollout.n
#
# This config sets:
# - rollout.batch_size=128, rollout.n=8 -> global prompts/step = 16
# - train.micro_batch_size_per_process=16 -> runner infers grad_accum_steps so update sees 128 sequences/step
#
# Intended use: v6e-8 single-host training (100 steps) with W&B logging.

model_path: Qwen/Qwen2.5-7B-Instruct

steps: 100

rollout:
  backend: naive
  batch_size: 128
  batch_size_per_process: null
  batch_size_per_device: null
  prompts_per_pass_per_process: null
  prompts_per_pass_per_device: null
  n: 8
  global_length: 512
  max_length_sample: 1024

train:
  global_micro_batch_size: null
  micro_batch_size_per_process: 16
  micro_batch_size_per_device: null
  ppo_epochs: 1
  beta: 0.0

mesh_shape: 1,-1,1

wandb_project: mllm-jax-grpo-gsm8k
wandb_name: null

reward_weights: [1.0, 0.5, 0.5]

eval_every_steps: 10
eval_batches_per_process: 1
eval_split: test
