base_model: Qwen/Qwen2.5-1.5B-Instruct
device: tpu
seed: 42

data:
  category: Industrial_and_Scientific
  train_file: workdir/MiniOneRec/data/Amazon/train/Industrial_and_Scientific_5_2016-10-2018-11.csv
  eval_file: workdir/MiniOneRec/data/Amazon/valid/Industrial_and_Scientific_5_2016-10-2018-11.csv
  test_file: workdir/MiniOneRec/data/Amazon/test/Industrial_and_Scientific_5_2016-10-2018-11.csv
  info_file: workdir/MiniOneRec/data/Amazon/info/Industrial_and_Scientific_5_2016-10-2018-11.txt
  sid_index_path: workdir/MiniOneRec/data/Amazon/index/Industrial_and_Scientific.index.json
  item_meta_path: workdir/MiniOneRec/data/Amazon/index/Industrial_and_Scientific.item.json
  init_from_sft_checkpoint: runs/sid_sft_jax_qwen25_1p5b_instruct_industrial_v6e8_full/sft_state_last.msgpack

tasks:
  next_item: true
  title2sid: true
  description2sid: true
  seqtitle2sid: true
  seqtitle2sid_sample: 10000

jax:
  mesh_shape: auto
  param_dtype: bfloat16
  compute_dtype: bfloat16
  max_cache_length: 512

rollout:
  prompt_batch_size: 64
  num_generations: 16
  prompt_pad_len: 256
  global_length: 512

train:
  num_train_epochs: 2
  grad_accum_steps: 2
  beta: 0.001
  logging_steps: 10
  save_last: true
  ema:
    enabled: true
    decay: 0.9998
    use_for_eval: true
  optimizer:
    name: adamw
    clip_norm: 0.3
    weight_decay: 1.0e-8
    lr_schedule:
      type: warmup_cosine
      warmup_ratio: 0.03
      init_value: 0.0
      peak_value: 1.0e-5
      end_value: 0.0

eval:
  enabled: true
  batch_size: 1
  num_beams: 50
  topk: [1, 3, 5, 10, 20, 50]
  save_predictions_json: true

wandb:
  project: minionerec-sid-rl
  mode: online

