# Eval-only config: valid split as "test", beam=20, starting from the pb32-aligned RL checkpoint.
#
# Upstream `workdir/MiniOneRec/rl.sh` passes `eval_file=valid/...` into training; some official reports may use
# the valid split for evaluation. This config helps compare apples-to-apples.

base_model: Qwen/Qwen2.5-1.5B
output_dir: runs/minionerec_rl_eval_valid_beam20_from_pb32_20260131
seed: 42
device: tpu

resume_from_checkpoint: runs/minionerec_rl_jax_qwen25_1p5b_base_industrial_v4_8_steps100_pb32_align_minionerec_rl_sh_20260131/sft_state_rl_last.msgpack

data:
  category: Industrial_and_Scientific
  train_file: workdir/MiniOneRec/data/Amazon/train/Industrial_and_Scientific_5_2016-10-2018-11.csv
  eval_file: workdir/MiniOneRec/data/Amazon/valid/Industrial_and_Scientific_5_2016-10-2018-11.csv
  test_file: workdir/MiniOneRec/data/Amazon/valid/Industrial_and_Scientific_5_2016-10-2018-11.csv
  info_file: workdir/MiniOneRec/data/Amazon/info/Industrial_and_Scientific_5_2016-10-2018-11.txt
  sid_index_path: workdir/MiniOneRec/data/Amazon/index/Industrial_and_Scientific.index.json
  max_len: 512
  sample_train: -1
  sample_eval: -1
  sample_test: -1

jax:
  mesh_shape: "4,1,1"
  param_dtype: bfloat16
  compute_dtype: bfloat16
  max_cache_length: 512

eval:
  enabled: true
  every_steps: 0
  batch_size: 4
  num_beams: 20
  topk: [1, 3, 5, 10, 20]
  save_predictions_json: true

wandb:
  project: minionerec-sid-rl
  mode: online
  name: null

